name: Move Issue to "In Progress" when Draft PR is Created

on:
  workflow_call:
  

jobs:
  move-issue:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Extract issue number from PR description
      id: extract_issue
      run: |
        issue=$(echo "${{ github.event.pull_request.body }}" | grep -oE '#[0-9]+' | head -n 1 | tr -d '#')
        echo "issue=$issue" >> $GITHUB_ENV

    - name: Move issue to "In Progress" column
      if: ${{ env.issue != '' }}
      uses: peter-evans/create-or-update-project-card@v3
      with:
        project-number: 5
        column-name: In Progress
        issue-number: ${{ env.issue }}
